
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Pterodactyl Attack</title>
<script src="lib/jquery-1.3.2.min.js"></script> 
<script src="lib/markdown.js"></script>
<link rel="stylesheet" href="reset.css" type="text/css" />
<link rel="stylesheet" href="main.css" type="text/css" />
</head>

<body>
<script>
	function selectIndex(i) {
		$('#preview1').removeClass('thumbnail-active');
		$('#preview2').removeClass('thumbnail-active');
		$('#preview3').removeClass('thumbnail-active');
		$('#preview4').removeClass('thumbnail-active');

		$('#preview'+i).addClass('thumbnail-active');
		$('#preview'+i+'txt').addClass('thumbtext-active');
		summary = [
			'Blast your way through waves of pterodactyls. Collect the right colors to boost your health. Experience beautifully animated environments. Survive the Pterror!',
			'Shoot pterodactyls by "throwing" bullets from the bottom orb.  In other words, touch the orb and swipe in the direction you want to shoot. Shoot as fast as you can!',
			'Capture pterodactyls that match the colored eggs (top-left).  This will earn you extra health.  Trust me, you\'ll need it!  Hold the net button with one finger while shooting with the other. But be careful, don\'t capture the wrong colors...',
			'You\'ll fly to a new area after every wave you survive.  Experience the serenity of a mountain landscape, the chill of a surreal arctic shelf, and the swelter of a volcanic cave.',
		][i-1];

		var s = $('#summary > p');
		s.css({'opacity': 0});
		s.text(summary);
		s.animate({'opacity': 1}, 500);
		updatePointer(i);
	}
	function updatePointer(i) {
		var s = $('#pointer');
		var perc = Math.floor((2*i-1)/8*100);
		s.css({'background-position': perc+"% 0"});
	}
	function clickIndex(i) {
		selectIndex(i);

		if (i == 1) {
			playYoutube('8UGHYdYx5dI');
		}
		else {
			loopVid([
				'vid/PteroShoot_small',
				'vid/PteroCapture_small',
				'vid/PteroScenery_small',
			][i-2]);
		}
	}
	function playYoutube(id) {
		var src = "http://www.youtube.com/embed/" + id + "?rel=0&amp;showinfo=0&amp;autoplay=1&amp;loop=1&amp;playlist="+id;
		$('#iphone-screen').html('<iframe src="' + src + '" height="100%" width="100%" allowfullscreen="" frameborder="0"></iframe>');
	}
	function loopVid(src) {
		var html = '<video id="video" width="100%" height="100%" autoplay="autoplay" loop="loop"><source src="' + src + '.mp4" type="video/mp4" /><source src="' + src + '.ogv" type="video/ogg" /></video>';
		$('#iphone-screen').html(html);
		$('#video').click(function(){this.paused?this.play():this.pause();});
	}
	$(function(){
		selectIndex(1);
	});
</script>
<div id="header-wrapper">
	<div id="header">
		<div id="logo">
			<img src="img/ptero_logo.png"/>
		</div>
		<div id="caption">
			A prehistoric arcade shooter!
		</div>
		<div id="appstore">
			<img src="img/appstore.png"/>
		</div>
		<div id="iphone-frame"><div id="iphone-screen"><img src="img/vid_preview.png" style="cursor: pointer" onclick="clickIndex(1)"/></div></div>
		<div id="thumbnails">
			<div onclick="clickIndex(1)" class="thumbnail" id="preview1"></div>
			<div onclick="clickIndex(2)" class="thumbnail" id="preview2"></div>
			<div onclick="clickIndex(3)" class="thumbnail" id="preview3"></div>
			<div onclick="clickIndex(4)" class="thumbnail" id="preview4"></div>
		</div>
		<div id="pointer">
		</div>
		<div id="summary">
			<p>
			</p>
		</div>
	</div>
</div>

<script>
	$(function(){
	});
	var learnOn = false;
	function getMinHeight() {
		return $('#learn-wrapper #nav').outerHeight(true);
	}
	function updateLearnHeight() {
		if (learnOn) {
			var h = $('#learn-wrapper #content').outerHeight(true);
			h = Math.max(h, getMinHeight());
			$('#learn-wrapper').css({'height': h+'px'});
		}
	}
	var $navBar;
	var $learnWrapper;
	function updateNavPosition() {
		if (learnOn) {
			var scrollPos = $(window).scrollTop();
			var learnTop = $learnWrapper.offset().top;
			var learnHeight = $learnWrapper.outerHeight();
			var navHeight = $navBar.outerHeight(true);

			var minY = learnTop;
			var maxY = Math.max(learnTop, learnTop+learnHeight - navHeight);

			var y = scrollPos;
			y = Math.max(minY, y);
			y = Math.min(maxY, y);

			y -= learnTop;

			$navBar.css({'top': y+"px"});
		}
	}
	function refreshScrollPosition() {
		var scrollPos = $(window).scrollTop();
		var learnTop = $('#question-wrapper').offset().top;
		if (scrollPos > learnTop) {
			$(window).scrollTop(learnTop);
		}
	}
	function initWithHash(hash) {
		var name = hash.substr(1);
		var names = [
			'preface',
			'intro',
			'quick-look',
			'flow',
			'gameplay',
			'tutorial',
			'surprise',
			'drawing',
			'paths',
			'textures',
			'env',
			'layouts',
			'aiming',
			'architecture',
			'files',
			'devops',
			'source-code',
		];
		var i,len=names.length;
		for (i=0; i<len; i++) {
			if (names[i] == name) {
				initWithLearn();
				loadArticle(name);
				break;
			}
		}
	}
	function initWithLearn() {
		learnOn = true;
		$learnWrapper.css({'height': getMinHeight()+'px'});
		$(window).scrollTop($('#question-wrapper').offset().top);
	}
	function toggleLearn() {
		window.location.hash = "#learn";
		learnOn = !learnOn;
		if (learnOn) {
			$learnWrapper.css({'height': getMinHeight()+'px'});
			$(window).scrollTop($('#question-wrapper').offset().top);
		}
		else {
			$learnWrapper.css({'height': 0});
		}
	}
	function loadArticle(name) {
		window.location.hash = "#"+name;

		function fixLinks(htmlTree) {
			if (htmlTree[0] === "img") {
				var attrs = htmlTree[1];
				var prefix = "img/";
				if (attrs.src.substring(0, prefix.length) === prefix) {
					attrs.src = "learn/" + attrs.src;
				}
			}
			else {
				var i, len=htmlTree.length;
				var node;
				for (i=0; i<len; i++) {
					node = htmlTree[i];
					if (Array.isArray(node)) {
						fixLinks(node);
					}
				}
			}
		}

		var src = "learn/"+name+".md";
		$.ajax({
			url: src,
			success: function(data) {
				var htmlTree = markdown.toHTMLTree(data);
				fixLinks(htmlTree);
				var html = markdown.renderJsonML(htmlTree);
				$('#learn-wrapper > #content').html(html);
				updateLearnHeight();
			},
			error: function() {
				$('#learn-wrapper > #content').html('failed');
			}
		});
		$('#learn-wrapper #nav li').css({
			'color':'#555',
		});
		$('#nav-'+name).css({
			'color': '#AA4B69',
		});

		refreshScrollPosition();
	}

	$(function(){
		$navBar = $('#learn-wrapper #nav');
		$learnWrapper = $('#learn-wrapper');
		var hash = window.location.hash;
		if (hash == "#learn") {
			initWithLearn();
		}
		else {
			initWithHash(hash);
		}
		window.setInterval(updateLearnHeight, 1000);
		$(window).scroll(updateNavPosition);
	});
</script>
<div id="question-wrapper" onclick="toggleLearn()">
	<img src="img/brain.png">Want to learn <em>how</em> we made it?
</div>
<div id="learn-wrapper">
	<div id="content">
		<div id="intro">
		here's how we did it!<br/><img src="img/learn_arrow.png"/>
		</div>
	</div>
	<div id="nav">
		<h2>Welcome</h2>
		<ul>
			<a href="#preface"><li id='nav-preface' onclick="loadArticle('preface')">Preface</li></a>
			<a href="#intro"><li id='nav-intro' onclick="loadArticle('intro')">Intro</li></a>
			<a href="#quick-look"><li id='nav-quick-look' onclick="loadArticle('quick-look')">Quick Look</li></a>
		</ul>
		<h2>Design</h2>
		<ul>
			<a href="#flow"><li id='nav-flow' onclick="loadArticle('flow')">Flow</li></a>
			<a href="#gameplay"><li id='nav-gameplay' onclick="loadArticle('gameplay')">Gameplay</li></a>
			<a href="#tutorial"><li id='nav-tutorial' onclick="loadArticle('tutorial')">Tutorial</li></a>
			<a href="#surprise"><li id='nav-surprise' onclick="loadArticle('surprise')">Surprise</li></a>
		</ul>
		<h2>Tech</h2>
		<ul>
			<a href="#drawing"><li id='nav-drawing' onclick="loadArticle('drawing')">Drawing</li></a>
			<a href="#paths"><li id='nav-paths' onclick="loadArticle('paths')">Paths</li></a>
			<a href="#textures"><li id='nav-textures' onclick="loadArticle('textures')">Textures</li></a>
			<a href="#env"><li id='nav-env' onclick="loadArticle('env')">Environments</li></a>
			<a href="#layouts"><li id='nav-layouts' onclick="loadArticle('layouts')">Layouts</li></a>
			<a href="#aiming"><li id='nav-aiming' onclick="loadArticle('aiming')">Aiming</li></a>
		</ul>
		<h2>Misc</h2>
		<ul>
			<a href="#architecture"><li id='nav-architecture' onclick="loadArticle('architecture')">Architecture</li></a>
			<a href="#files"><li id='nav-files' onclick="loadArticle('files')">Files</li></a>
			<a href="#devops"><li id='nav-devops' onclick="loadArticle('devops')">DevOps</li></a>
			<a href="#source-code"><li id='nav-source-code' onclick="loadArticle('source-code')">Source Code</li></a>
		</ul>
	</div>
</div>
<div id="footer-wrapper">
	<div id="footer">
		<div class="inline" id="octopus">
			<a href="http://twitter.com/shaunewilliams">@shaunewilliams</a>
		</div>
		<div class="inline sep">-</div>
		<div class="inline" id="hygoon">
			<a href="http://hygoon.com">Hygoon Studio</a>
		</div>
		<div class="inline sep">-</div>
		<div class="inline">
			<img src="img/appstore.png"/>
		</div>
		<div class="inline sep">-</div>
		<div class="inline">
			<a href="http://hygoon.com/press">presskit()</a>
		</div>
	</div>
</div>
<div id="copyright">
	Made in 2013 - The Year of the Pterodactyl
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46053002-2', 'pteroattack.com');
  ga('send', 'pageview');

</script>
</body>

</html>
